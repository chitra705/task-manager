<style>
  .leave-reason-cell:hover .leave-reason {
    display: inline !important;
  }
  .table-wrapper {
    padding-left: 120px;
    padding-right: 120px;
    margin: 20px auto;
    border-radius: 8px;
    min-height: 500px;
  }


thead th {
    border-bottom-width: 2px;
    background-color: #010101 !important;
    color:#BDBDBD !important;
}
.table-bordered td, .table-bordered th {
    border: 1px solid #dee2e600;
}
</style>


<!-- Modal Structure -->
<div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="imageModalLabel">Image Details</h5>
        <!-- Replace btn-close with a custom icon -->
        
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body text-center">
        <%= image_tag "", id: "modalImage", class: "img-fluid" %> <!-- Responsive image -->
      </div>
      
    </div>
  </div>
</div>


<!-- Add responsive table wrapper -->
<div class="table-responsive table-wrapper mt-5">
  <table class="table table-striped table-bordered">
    <thead> 
      <tr>
        <th>Date</th>
        <th>Emp ID</th>
        <th>Name</th>
        <th>Total Salary</th>
        <th>Given Amount</th>
        <th>Balance Amount</th>
        <th>Details</th>

        <th class="text-center" colspan="3">Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @payment_details.each do |payment| %>
        <tr>
          <td><%= payment.created_at.strftime('%d %b %Y') %></td>
          <td><%= payment.emp_id %></td>
          <td><%= payment.emp.name %></td>
          <td><%= payment.total_salary %></td>

          <td>
            <%= form_with url: given_update_payment_detail_path(payment), method: :post, local: true do |f| %>
              <%= f.number_field :given_amount, value: payment.given_amount, class: "form-control", step: 0.01 %>
          </td>
          <td>
             <%= payment.total_salary - (payment.given_amount || 0) %>

          </td>
          <td>
              <%= f.file_field :details_img, class: "form-control" %>
          </td>
          <td>
            <%= f.submit "Update", class: "btn btn-primary btn-sm" %>
            <% end %>
          </td>

          <td class="leave-reason-cell">
            <% if payment.details_img.attached? %>
              <%= link_to "#", data: { toggle: "modal", target: "#imageModal", image: rails_blob_path(payment.details_img, only_path: true) }, class: "hover-text btn btn-link text-decoration-none" do %>
                view image
              <% end %>
            <% else %>
              <span class="text-muted">No Image</span>
            <% end %>
          </td>

          <td>
            <%= link_to 'Delete', delete_pd_payment_detail_path(payment.id), class: "btn btn-danger btn-sm" %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>

<script>
  // Ensure jQuery is loaded and available
  $('#imageModal').on('show.bs.modal', function (event) {
    var link = $(event.relatedTarget); // Button that triggered the modal
    var imageUrl = link.data('image'); // Extract image URL from data-* attributes
    var modal = $(this);
    modal.find('#modalImage').attr('src', imageUrl); // Update modal image
  });


</script>

